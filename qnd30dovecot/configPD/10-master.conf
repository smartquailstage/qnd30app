# Configuración para los servicios IMAP, POP3 y otros protocolos
service imap-login {
  inet_listener imap {
    port = 143            # Puerto IMAP sin SSL
    ssl = no              # No habilitar SSL en IMAP
  }
  inet_listener imaps {
    port = 993            # Puerto IMAPS con SSL
    ssl = yes             # Habilitar SSL en IMAPS
  }
}

service pop3-login {
  inet_listener pop3 {
    port = 110            # Puerto POP3 sin SSL
    ssl = no              # Deshabilitar POP3 sin SSL
  }
  inet_listener pop3s {
    port = 995            # Puerto POP3S con SSL
    ssl = yes             # Habilitar SSL en POP3S
  }
}

service submission-login {
  inet_listener submission {
    port = 587            # Puerto SMTP Submission (envío de correos)
    ssl = yes             # Habilitar SSL para el puerto 587 (Submission)
  }
}

# Configuración del servicio LMTP para la entrega local
service lmtp {
  unix_listener /var/spool/postfix/private/dovecot-lmtp {
    user = postfix        # Usuario postfix para el servicio LMTP
    group = postfix       # Grupo postfix para el servicio LMTP
    mode = 0660           # Permisos para el socket de LMTP
  }
}

# Configuración del servicio de autenticación
service auth {
  unix_listener auth {
    mode = 0660           # Permisos para el socket de autenticación
    user = dovecot        # Usuario que tiene acceso al socket
    group = dovecot       # Grupo que tiene acceso al socket
    path = /var/spool/postfix/private/auth  # Ruta del socket de autenticación
  }

  # Listener para auth-userdb (usuario de autenticación)
  unix_listener auth-userdb {
    mode = 0660           # Permisos para el socket auth-userdb
    user = dovecot        # Usuario para auth-userdb
    group = dovecot       # Grupo para auth-userdb
  }

  # Listener para auth-client (cliente de autenticación)
  unix_listener auth-client {
    mode = 0660           # Permisos para el socket auth-client
    user = dovecot        # Usuario para auth-client
    group = dovecot       # Grupo para auth-client
  }
}

# Configuración del servicio auth-worker (opcional, para trabajadores de autenticación)
service auth-worker {
  user = dovecot         # Usuario para el worker de autenticación
}

# Definir el grupo privilegiado para el servicio de correo
mail_privileged_group = mail
