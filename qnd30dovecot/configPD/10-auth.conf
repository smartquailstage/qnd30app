auth_mechanisms = plain login
auth_verbose = yes
auth_debug = yes
auth_debug_passwords = yes

# Configuración de socket para la autenticación (sin el bloque 'auth {}')
# Dovecot ahora usa unix_listener para manejar las conexiones de Postfix
unix_listener /var/spool/postfix/private/auth {
  mode = 0660
  user = postfix
  group = postfix
}

# Configuración del servicio de autenticación
service auth {
  client_limit = 2000
}

# Configuración del servicio LMTP (Local Mail Transfer Protocol)
service lmtp {
  unix_listener /var/spool/postfix/private/dovecot-lmtp {
    user = postfix
    group = postfix
    mode = 0660
  }
}

# Configuración de servicios IMAP e IMAPS
service imap-login {
  inet_listener imap {
    port = 143
  }
  inet_listener imaps {
    port = 993
    ssl = yes
  }
}

# Configuración de servicios POP3 y POP3S
service pop3-login {
  inet_listener pop3 {
    port = 0  # No se activa POP3, solo POP3S
  }
  inet_listener pop3s {
    port = 995
    ssl = yes
  }
}

# Configuración del servicio de envío de correo (Submission)
service submission-login {
  inet_listener submission {
    port = 587
    ssl = yes
  }
  process_min_avail = 1
  client_limit = 1000
  service_count = 0
}

# Configuración del servicio Managesieve
service managesieve-login {
  process_min_avail = 1
  client_limit = 1000
  service_count = 0
}

# Configuración del trabajador de autenticación
service auth-worker {
  user = dovecot
}

# Configuración del grupo privilegiado para correos
mail_privileged_group = mail

# Incluir configuración de autenticación SQL si se necesita
!include auth-sql.conf.ext
