###########################
# Dovecot Authentication Configuration
###########################

# Configuración general de autenticación
auth_mechanisms = plain login
# Define los mecanismos de autenticación que Dovecot usará. En este caso 'plain' y 'login' son comunes.
# Si usas otros mecanismos como 'cram-md5', 'digest-md5' o 'gssapi', puedes agregarlos aquí.

# Configuración de la base de datos de contraseñas
passdb {
  # Configuración de base de datos para contraseñas
  driver = sql
  args = /etc/dovecot/dovecot-sql.conf.ext
  # El archivo 'dovecot-sql.conf.ext' contiene las configuraciones SQL para conectar a la base de datos.
  # Aquí se definen cómo buscar las contraseñas y la relación con los usuarios.

  # Otros mecanismos de autenticación como 'pam' o 'ldap' también pueden ser configurados en lugar de 'sql'.
  # Ejemplo:
  # driver = pam
  # o
  # driver = ldap
}


# Establecer la política de autenticación
auth_default_realm = juansilvaphoto.com
# Esto establece el dominio predeterminado que se agrega a los usuarios no calificados (por ejemplo, 'usuario' se convierte en 'usuario@example.com').

# Configuración para habilitar el uso de la autenticación SASL
auth_socket_path = /var/spool/postfix/private/auth
# Esto es necesario si Postfix está configurado para autenticar a través de Dovecot usando SASL.
# El archivo de socket de autenticación se debe especificar aquí para permitir la autenticación compartida entre Dovecot y Postfix.

# Habilitar autenticación a través de SSL
ssl_cert = </etc/ssl/certs/fullchain.pem
ssl_key = </etc/ssl/private/privkey.pem
# Certificado SSL y clave privada necesarios si se utiliza una conexión segura.

# Restricciones de autenticación

# Configura la base de datos del usuario para autenticar a los usuarios. En este caso, se usa 'sql' para conectarse a una base de datos.
# Si usas otro sistema de autenticación como 'passwd', puedes cambiar esto a 'passwd'.

# Verificación del correo en base a la dirección completa
auth_username_format = %n
# Esto le dice a Dovecot cómo manejar el nombre de usuario. %n es para tomar el nombre de usuario tal como es (sin el dominio). Si quieres incluir el dominio, usa %u.

# Configuración de la duración del cache de autenticación
auth_cache_size = 512M
auth_cache_ttl = 1h
# Define la memoria caché para los usuarios autenticados y cuánto tiempo se mantienen los datos en caché.

# Configuración para la autenticación PAM (si es necesario)
# auth_pam_service = dovecot
# Si se desea utilizar PAM (Pluggable Authentication Module), se puede habilitar esta opción.

# Configuración de la autenticación de múltiples dominios
# auth_verbose = yes
# Establecer a "yes" habilita un logging más detallado de la autenticación para facilitar la depuración.

###########################
# Habilitación de otros métodos de autenticación
###########################

# Si tienes una base de datos LDAP para la autenticación, puedes habilitarla aquí:
# auth_driver = ldap
# auth_ldap_servers = /etc/dovecot/ldap.conf.ext

###########################
# Otros ajustes de seguridad
###########################

# Habilitar la autenticación segura
auth_ssl_required = yes
# Esto asegura que los usuarios solo puedan autenticarse si están usando una conexión SSL.

# Desactivar la autenticación para métodos inseguros
disable_plaintext_auth = yes
# Desactiva la autenticación de texto sin formato si no se usa SSL/TLS, lo cual es importante para la seguridad.

# Limitar intentos de autenticación para evitar ataques de fuerza bruta
auth_failed_attempts = 3
auth_jailed_attempts = 5
# Número de intentos fallidos antes de que se bloquee la cuenta temporalmente.

